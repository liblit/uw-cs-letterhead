% -*- TeX-PDF-mode: t; TeX-master: "example" -*-

\usepackage{etoolbox}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{textcomp}

% font selection
\usepackage[scaled]{helvet}
\usepackage{microtype}

\newtoggle{preprinted}
\DeclareOption{preprinted}{\toggletrue{preprinted}}
\ProcessOptions


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  page geometry and margins
%

\newsavebox{\@uwlogo}
%% 51/32 inches
\savebox{\@uwlogo}{\includegraphics[width=114pt]{uw-logo}}
\newlength{\@uwlogoheight}
\settoheight{\@uwlogoheight}{\usebox{\@uwlogo}}
\addtolength{\@uwlogoheight}{4.5pt}

\newcommand{\@uwfootpage}{%
  \begin{minipage}[b]{\textwidth}
    \sffamily

    \begin{center}

      \fontsize{11}{13}\selectfont

      \textbf{%
	\ifcsempty{fromname}{}{\fromname, }%
	Computer Sciences Department}

      \fontsize{10}{12}\selectfont

      University of Wisconsin--Madison \quad
      1210 W. Dayton Street \quad
      Madison, Wisconsin 53706

      \providecommand{\emailaddr}[0]{}
      \providecommand{\@fax}[0]{}
      \providecommand{\weburl}[0]{}

      \telephonenum \quad
      Fax: \@fax \quad
      E-mail: \emailaddr \quad
      \weburl

    \end{center}
  \end{minipage}}

\newsavebox{\@uwfootbox}
\sbox{\@uwfootbox}{\@uwfootpage}
\newlength{\@uwfootheight}
\settoheight{\@uwfootheight}{\usebox{\@uwfootbox}}

\addtolength{\@uwfootheight}{0.5in}

\geometry{letterpaper,includehead,includefoot,top=1in,bottom=0.2in,head=\@uwlogoheight,foot=\@uwfootheight,headsep=0.5in}

\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\nottoggle{preprinted}{
  \fancyhead[C]{\usebox{\@uwlogo}}
  \fancyfoot[C]{\@uwfootpage}
}

\fancypagestyle{firstpage}{%
  \pagestyle{empty}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% macros for customizing footer content
%

\newcommand{\username}[1]{\def\@username{#1}}
\newcommand{\extension}[1]{\def\@extension{#1}}

\newcommand{\@fax}[0]{\href{fax:+1-(608)-262-9777}{608/262-9777}}

\newcommand{\emailaddr}[0]{\href{mailto:\@username%
@cs.wisc.edu}{\@username{}@cs.wisc.edu}}

\newcommand{\weburl}[0]{
  \ifcsequal{\@username}{cs}{%
    \href{http://www.cs.wisc.edu/}{www.cs.wisc.edu}}{%
    \href{http://pages.cs.wisc.edu/~\@username/}{pages.cs.wisc.edu/\texttildelow\@username}}}

\telephone{\href{tel:+1-(608)-26\@extension}{608/26\@extension}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  default footer content
%

\username{cs}
\extension{2-1204}
